<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · Imbalance.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="https://fonts.googleapis.com/css?family=Montserratwght@100;200;300;400;500;600;700;800;900|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.gif" alt="Imbalance.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>Imbalance.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Introduction</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Quick-Start"><span>Quick Start</span></a></li><li><a class="tocitem" href="#Features"><span>Features</span></a></li><li><a class="tocitem" href="#Methods"><span>Methods</span></a></li><li><a class="tocitem" href="#Rationale"><span>Rationale</span></a></li></ul></li><li><a class="tocitem" href="user_guide/">User Guide</a></li><li><a class="tocitem" href="algorithms/">Algorithms</a></li><li><a class="tocitem" href="theory/">Theory</a></li><li><a class="tocitem" href="examples/">Examples</a></li><li><a class="tocitem" href="contributing/">Contributing</a></li><li><a class="tocitem" href="about/">About</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaAI/Imbalance.jl/" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Imbalance.jl"><a class="docs-heading-anchor" href="#Imbalance.jl">Imbalance.jl</a><a id="Imbalance.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Imbalance.jl" title="Permalink"></a></h1><p><img src="https://i.imgur.com/C34ilSZ.png" alt="Imbalance"/></p><p>A Julia package with resampling methods to correct for class imbalance in a wide variety of classification settings.</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><pre><code class="language-julia hljs">import Pkg;
Pkg.add(&quot;Imbalance&quot;)</code></pre><h2 id="Quick-Start"><a class="docs-heading-anchor" href="#Quick-Start">Quick Start</a><a id="Quick-Start-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start" title="Permalink"></a></h2><p>We will illustrate using the package to oversample with<code>SMOTE</code>; however, all other implemented oversampling methods follow the same pattern.</p><h3 id="Standard-API"><a class="docs-heading-anchor" href="#Standard-API">Standard API</a><a id="Standard-API-1"></a><a class="docs-heading-anchor-permalink" href="#Standard-API" title="Permalink"></a></h3><p>All methods by default support a pure functional interface.</p><pre><code class="language-julia hljs">using Imbalance

# Set dataset properties then generate imbalanced data
probs = [0.5, 0.2, 0.3]                  # probability of each class      
num_rows, num_continuous_feats = 100, 5
X, y = generate_imbalanced_data(num_rows, num_continuous_feats; probs, rng=42)      

# Apply SMOTE to oversample the classes
Xover, yover = smote(X, y; k=5, ratios=Dict(0=&gt;1.0, 1=&gt; 0.9, 2=&gt;0.8), rng=42)
</code></pre><h3 id="MLJ-Interface"><a class="docs-heading-anchor" href="#MLJ-Interface">MLJ Interface</a><a id="MLJ-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#MLJ-Interface" title="Permalink"></a></h3><p>All methods support the <code>MLJ</code> interface over tables where instead of directly calling the method, one instantiates a model for the method while optionally passing the keyword parameters found in the functional interface then wraps the model in a <code>machine</code> and follows by calling <code>transform</code> on the machine and data.</p><pre><code class="language-julia hljs">using MLJ

# Load the model
SMOTE = @load SMOTE pkg=Imbalance

# Create an instance of the model 
oversampler = SMOTE(k=5, ratios=Dict(0=&gt;1.0, 1=&gt; 0.9, 2=&gt;0.8), rng=42)

# Wrap it in a machine
mach = machine(oversampler)

# Provide the data to transform 
Xover, yover = transform(mach, X, y)</code></pre><p>All implemented oversampling methods are considered static transforms and hence, no <code>fit</code> is required. </p><h3 id="Table-Transforms-Interface"><a class="docs-heading-anchor" href="#Table-Transforms-Interface">Table Transforms Interface</a><a id="Table-Transforms-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Table-Transforms-Interface" title="Permalink"></a></h3><p>This interface operates on single tables; it assumes that <code>y</code> is one of the columns of the given table. Thus, it follows a similar pattern to the <code>MLJ</code> interface except that the index of <code>y</code> is a required argument while instantiating the model and the data to be transformed via <code>apply</code> is only one table <code>Xy</code>.</p><pre><code class="language-julia hljs">using Imbalance
using TableTransforms

# Generate imbalanced data
num_rows = 200
num_features = 5
y_ind = 3
Xy, _ = generate_imbalanced_data(num_rows, num_features; 
                                 probs=[0.5, 0.2, 0.3], insert_y=y_ind, rng=42)

# Initiate SMOTE model
oversampler = SMOTE_t(y_ind; k=5, ratios=Dict(0=&gt;1.0, 1=&gt; 0.9, 2=&gt;0.8), rng=42)
Xyover = Xy |&gt; oversampler       # can chain with other table transforms                  
Xyover, cache = TableTransforms.apply(oversampler, Xy)    # equivalently</code></pre><p>The <code>reapply(oversampler, Xy, cache)</code> method from <code>TableTransforms</code> simply falls back to <code>apply(oversample, Xy)</code> and the <code>revert(oversampler, Xy, cache)</code> reverts the transform by removing the oversampled observations from the table.</p><h2 id="Features"><a class="docs-heading-anchor" href="#Features">Features</a><a id="Features-1"></a><a class="docs-heading-anchor-permalink" href="#Features" title="Permalink"></a></h2><ul><li>Provides some of the most sought oversampling algorithms in machine learning and is still under development</li><li>Supports multi-class classification and both nominal and continuous features</li><li>Generic by supporting table input/output formats as well as matrices</li><li>Provides <code>MLJ</code> and <code>TableTransforms</code> interfaces aside from the default pure functional interface</li><li>Supports tables regardless to whether the target is a separate column or one of the columns</li><li>Supports automatic encoding and decoding of nominal features</li></ul><h2 id="Methods"><a class="docs-heading-anchor" href="#Methods">Methods</a><a id="Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Methods" title="Permalink"></a></h2><p>The package so far provides five oversampling algorithms that all work in multi-class settings and with options for handling continuous and nominal features. In particular, it implements:</p><ul><li>Basic Random Oversampling </li><li>Random Sampling Examples (ROSE)</li><li>Synthetic Minority Oversampling Technique (SMOTE)</li><li>SMOTE-Nominal (SMOTE-N)</li><li>SMOTE-Nominal Categorical (SMOTE-NC)</li></ul><h2 id="Rationale"><a class="docs-heading-anchor" href="#Rationale">Rationale</a><a id="Rationale-1"></a><a class="docs-heading-anchor-permalink" href="#Rationale" title="Permalink"></a></h2><p>Most if not all machine learning algorithms can be viewed as a form of empirical risk minimization where the object is to find the parameters <span>$\theta$</span> that for some loss function <span>$L$</span> minimize </p><p class="math-container">\[\hat{\theta} = \arg\min_{\theta} \frac{1}{N} \sum_{i=1}^{N} L(f_{\theta}(x_i), y_i)\]</p><p>The underlying assumption is that minimizing this empirical risk corresponds to approximately minimizing the true risk which considers all examples in the populations which would imply that <span>$f_\theta$</span> is approximately the true target function <span>$f$</span> that we seek to model.</p><p>In a multi-class setting with <span>$K$</span> classes, one can write</p><p class="math-container">\[\hat{\theta} = \arg\min_{\theta} \left( \frac{1}{N_1} \sum_{i \in C_1} L(f_{\theta}(x_i), y_i) + \frac{1}{N_2} \sum_{i \in C_2} L(f_{\theta}(x_i), y_i) + \ldots + \frac{1}{N_K} \sum_{i \in C_K} L(f_{\theta}(x_i), y_i) \right)\]</p><p>Class imbalance occurs when some classes have much fewer examples than other classes. In this case, the corresponding terms contribute minimally to the sum which makes it easier for any learning algorithm to find an approximate solution to the empirical risk that mostly only minimizes the over the significant sums. This yields a hypothesis <span>$f_\theta$</span> that may be very different from the true target <span>$f$</span> with respect to the minority classes which may be the most important for the application in question.</p><p>One obvious possible remedy is to weight the smaller sums so that a learning algorithm more easily avoids approximate solutions that exploit their insignificance which can be seen to be equivalent to repeating examples of the observations in minority classes. This can be achieved by naive random oversampling which is offered by this package along with other more advanced oversampling methods.</p><p>To our knowledge, there are no existing maintained Julia packages that implement oversampling algorithms for multi-class classification problems or that handle both nominal and continuous features. This has served as a primary motivation for the creation of this package.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="user_guide/">User Guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 4 September 2023 18:07">Monday 4 September 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
