<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Imports Â· Imbalance.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="https://fonts.googleapis.com/css?family=Montserratwght@100;200;300;400;500;600;700;800;900|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.gif" alt="Imbalance.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Imbalance.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../algorithms/">Algorithms</a></li><li><a class="tocitem" href="../../walkthrough/">Walkthrough</a></li><li><a class="tocitem" href="../">Examples</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../about/">About</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Imports</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Imports</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaAI/Imbalance.jl/" title="Edit on GitHub"><span class="docs-icon fab">ï‚›</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Imports"><a class="docs-heading-anchor" href="#Imports">Imports</a><a id="Imports-1"></a><a class="docs-heading-anchor-permalink" href="#Imports" title="Permalink"></a></h1><pre><code class="language-julia hljs">using Random
using CSV
using DataFrames
using MLJ
using ScientificTypes
using Imbalance
using Plots</code></pre><h2 id="Loading-Data"><a class="docs-heading-anchor" href="#Loading-Data">Loading Data</a><a id="Loading-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-Data" title="Permalink"></a></h2><p>Let&#39;s load the Iris dataset, the objective of this dataset is to predict the type of flower as one of &quot;virginica&quot;, &quot;versicolor&quot; and &quot;setosa&quot; using its sepal and petal length and width. </p><p>We don&#39;t need to so from a CSV file this time because <code>MLJ</code> has a macro for loading it already! The only difference is that we will need to explictly convert it to a dataframe as <code>MLJ</code> loads it as a named tuple of vectors.</p><pre><code class="language-julia hljs">X, y = @load_iris
X = DataFrame(X)
first(X, 5) |&gt; pretty</code></pre><pre><code class="nohighlight hljs">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ sepal_length â”‚ sepal_width â”‚ petal_length â”‚ petal_width â”‚
â”‚ Float64      â”‚ Float64     â”‚ Float64      â”‚ Float64     â”‚
â”‚ Continuous   â”‚ Continuous  â”‚ Continuous   â”‚ Continuous  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5.1          â”‚ 3.5         â”‚ 1.4          â”‚ 0.2         â”‚
â”‚ 4.9          â”‚ 3.0         â”‚ 1.4          â”‚ 0.2         â”‚
â”‚ 4.7          â”‚ 3.2         â”‚ 1.3          â”‚ 0.2         â”‚
â”‚ 4.6          â”‚ 3.1         â”‚ 1.5          â”‚ 0.2         â”‚
â”‚ 5.0          â”‚ 3.6         â”‚ 1.4          â”‚ 0.2         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><p>Our purpose for this tutorial is primarily visuallization. Thus, let&#39;s select two of the continuous features only to work with. It&#39;s known that the sepal length and width play a much bigger role in classifying the type of flower so let&#39;s keep those only.</p><pre><code class="language-julia hljs">X = select(X, :petal_width, :petal_length)
first(X, 5) |&gt; pretty</code></pre><pre><code class="nohighlight hljs">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ petal_width â”‚ petal_length â”‚
â”‚ Float64     â”‚ Float64      â”‚
â”‚ Continuous  â”‚ Continuous   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0.2         â”‚ 1.4          â”‚
â”‚ 0.2         â”‚ 1.4          â”‚
â”‚ 0.2         â”‚ 1.3          â”‚
â”‚ 0.2         â”‚ 1.5          â”‚
â”‚ 0.2         â”‚ 1.4          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><h2 id="Coercing-Data"><a class="docs-heading-anchor" href="#Coercing-Data">Coercing Data</a><a id="Coercing-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Coercing-Data" title="Permalink"></a></h2><pre><code class="language-julia hljs">ScientificTypes.schema(X)</code></pre><pre><code class="nohighlight hljs">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ names        â”‚ scitypes   â”‚ types   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ petal_width  â”‚ Continuous â”‚ Float64 â”‚
â”‚ petal_length â”‚ Continuous â”‚ Float64 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><p>Things look good, no coercion is needed.</p><h2 id="Oversampling"><a class="docs-heading-anchor" href="#Oversampling">Oversampling</a><a id="Oversampling-1"></a><a class="docs-heading-anchor-permalink" href="#Oversampling" title="Permalink"></a></h2><p>Iris, by default has no imbalance problem</p><pre><code class="language-julia hljs">checkbalance(y)</code></pre><pre><code class="nohighlight hljs">virginica:  â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 50 (100.0%) 
setosa:     â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 50 (100.0%) 
versicolor: â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 50 (100.0%)</code></pre><p>To simulate that there is a balance problem, we will consider a random sample of 100 observations. A random sample does not guarantee perserving the proportion of classes; in this, we actually set the seed to get a very unlikely random sample that suffers from strong imbalance.</p><pre><code class="language-julia hljs">Random.seed!(803429)
subset_indices = rand(1:size(X, 1), 100)
X, y = X[subset_indices, :], y[subset_indices]
checkbalance(y)</code></pre><pre><code class="nohighlight hljs">versicolor: â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 12 (22.6%) 
setosa:     â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 35 (66.0%) 
virginica:  â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 53 (100.0%)</code></pre><p>We will treat this as our training set going forward so we don&#39;t need to partition. Now let&#39;s oversample it with ROSE.</p><pre><code class="language-julia hljs">Xover, yover = rose(X, y; s=0.3, ratios=Dict(&quot;versicolor&quot; =&gt; 1.0, &quot;setosa&quot;=&gt;1.0))
checkbalance(yover)</code></pre><pre><code class="nohighlight hljs">Progress:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–             |  ETA: 0:00:00[K
[A

virginica:  â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 53 (100.0%) 
setosa:     â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 53 (100.0%) 
versicolor: â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 53 (100.0%)</code></pre><h2 id="Training-the-Model"><a class="docs-heading-anchor" href="#Training-the-Model">Training the Model</a><a id="Training-the-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Training-the-Model" title="Permalink"></a></h2><pre><code class="language-julia hljs">models(matching(Xover, yover))</code></pre><pre><code class="nohighlight hljs">53-element Vector{NamedTuple{(:name, :package_name, :is_supervised, :abstract_type, :deep_properties, :docstring, :fit_data_scitype, :human_name, :hyperparameter_ranges, :hyperparameter_types, :hyperparameters, :implemented_methods, :inverse_transform_scitype, :is_pure_julia, :is_wrapper, :iteration_parameter, :load_path, :package_license, :package_url, :package_uuid, :predict_scitype, :prediction_type, :reporting_operations, :reports_feature_importances, :supports_class_weights, :supports_online, :supports_training_losses, :supports_weights, :transform_scitype, :input_scitype, :target_scitype, :output_scitype)}}:
 (name = AdaBoostClassifier, package_name = MLJScikitLearnInterface, ... )
 (name = AdaBoostStumpClassifier, package_name = DecisionTree, ... )
 (name = BaggingClassifier, package_name = MLJScikitLearnInterface, ... )
 (name = BayesianLDA, package_name = MLJScikitLearnInterface, ... )
 (name = BayesianLDA, package_name = MultivariateStats, ... )
 (name = BayesianQDA, package_name = MLJScikitLearnInterface, ... )
 (name = BayesianSubspaceLDA, package_name = MultivariateStats, ... )
 (name = CatBoostClassifier, package_name = CatBoost, ... )
 (name = ConstantClassifier, package_name = MLJModels, ... )
 (name = DecisionTreeClassifier, package_name = BetaML, ... )
 â‹®
 (name = SGDClassifier, package_name = MLJScikitLearnInterface, ... )
 (name = SVC, package_name = LIBSVM, ... )
 (name = SVMClassifier, package_name = MLJScikitLearnInterface, ... )
 (name = SVMLinearClassifier, package_name = MLJScikitLearnInterface, ... )
 (name = SVMNuClassifier, package_name = MLJScikitLearnInterface, ... )
 (name = StableForestClassifier, package_name = SIRUS, ... )
 (name = StableRulesClassifier, package_name = SIRUS, ... )
 (name = SubspaceLDA, package_name = MultivariateStats, ... )
 (name = XGBoostClassifier, package_name = XGBoost, ... )</code></pre><p>Let&#39;s go for a <a href="https://alan-turing-institute.github.io/MLJ.jl/dev/models/KernelPerceptron_BetaML/#KernelPerceptron_BetaML">Kernel Perceptron</a>. This is just like the normal perceptron but it learns the separating hyperplane in a higher dimensional space using the kernel trick so that it corresponds to a nonlinear separating hypersurface in the original space. This isn&#39;t necessarily helpful in our case, but just to experiment.</p><pre><code class="language-julia hljs">import Pkg; Pkg.add(&quot;BetaML&quot;)</code></pre><pre><code class="nohighlight hljs">    Updating registry at `~/.julia/registries/General.toml`
   Resolving package versions...
  No Changes to `~/Documents/GitHub/Imbalance.jl/Project.toml`
  No Changes to `~/Documents/GitHub/Imbalance.jl/Manifest.toml`</code></pre><h3 id="Before-Oversampling"><a class="docs-heading-anchor" href="#Before-Oversampling">Before Oversampling</a><a id="Before-Oversampling-1"></a><a class="docs-heading-anchor-permalink" href="#Before-Oversampling" title="Permalink"></a></h3><pre><code class="language-julia hljs"># 1. Load the model
KernelPerceptron = @load KernelPerceptron pkg=BetaML

# 2. Instantiate it 
model = KernelPerceptron(kernel = BetaML.Utils.radial_kernel, epochs = 10)

# 3. Wrap it with the data in a machine
mach = machine(model, X, y)

# 4. fit the machine learning model
fit!(mach, verbosity=0)</code></pre><pre><code class="nohighlight hljs">â”Œ Info: For silent loading, specify `verbosity=0`. 
â”” @ Main /Users/essam/.julia/packages/MLJModels/7apZ3/src/loading.jl:159


import BetaML âœ”



trained Machine; caches model-specific representations of data
  model: KernelPerceptron(kernel = radial_kernel, â€¦)
  args: 
    1:	Source @188 â Table{AbstractVector{Continuous}}
    2:	Source @670 â AbstractVector{Multiclass{3}}</code></pre><h3 id="After-Oversampling"><a class="docs-heading-anchor" href="#After-Oversampling">After Oversampling</a><a id="After-Oversampling-1"></a><a class="docs-heading-anchor-permalink" href="#After-Oversampling" title="Permalink"></a></h3><pre><code class="language-julia hljs"># 3. Wrap it with the data in a machine
mach_over = machine(model, Xover, yover)

# 4. fit the machine learning model
fit!(mach_over, verbosity=0)</code></pre><pre><code class="nohighlight hljs">trained Machine; caches model-specific representations of data
  model: KernelPerceptron(kernel = radial_kernel, â€¦)
  args: 
    1:	Source @565 â Table{AbstractVector{Continuous}}
    2:	Source @167 â AbstractVector{Multiclass{3}}</code></pre><h2 id="Plot-Decision-Boundaries"><a class="docs-heading-anchor" href="#Plot-Decision-Boundaries">Plot Decision Boundaries</a><a id="Plot-Decision-Boundaries-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-Decision-Boundaries" title="Permalink"></a></h2><p>Construct ranges for each feature and consecutively a grid</p><pre><code class="language-julia hljs">petal_width_range =
	range(minimum(X.petal_width) - 1, maximum(X.petal_width) + 1, length = 200)
petal_length_range =
	range(minimum(X.petal_length) - 1, maximum(X.petal_length) + 1, length = 200)
grid_points = [(pw, pl) for pw in petal_width_range, pl in petal_length_range]
</code></pre><pre><code class="nohighlight hljs">200Ã—200 Matrix{Tuple{Float64, Float64}}:
 (-0.9, 0.2)       (-0.9, 0.238693)       â€¦  (-0.9, 7.9)
 (-0.878894, 0.2)  (-0.878894, 0.238693)     (-0.878894, 7.9)
 (-0.857789, 0.2)  (-0.857789, 0.238693)     (-0.857789, 7.9)
 (-0.836683, 0.2)  (-0.836683, 0.238693)     (-0.836683, 7.9)
 (-0.815578, 0.2)  (-0.815578, 0.238693)     (-0.815578, 7.9)
 (-0.794472, 0.2)  (-0.794472, 0.238693)  â€¦  (-0.794472, 7.9)
 (-0.773367, 0.2)  (-0.773367, 0.238693)     (-0.773367, 7.9)
 (-0.752261, 0.2)  (-0.752261, 0.238693)     (-0.752261, 7.9)
 (-0.731156, 0.2)  (-0.731156, 0.238693)     (-0.731156, 7.9)
 (-0.71005, 0.2)   (-0.71005, 0.238693)      (-0.71005, 7.9)
 â‹®                                        â‹±  
 (3.13116, 0.2)    (3.13116, 0.238693)       (3.13116, 7.9)
 (3.15226, 0.2)    (3.15226, 0.238693)       (3.15226, 7.9)
 (3.17337, 0.2)    (3.17337, 0.238693)       (3.17337, 7.9)
 (3.19447, 0.2)    (3.19447, 0.238693)       (3.19447, 7.9)
 (3.21558, 0.2)    (3.21558, 0.238693)    â€¦  (3.21558, 7.9)
 (3.23668, 0.2)    (3.23668, 0.238693)       (3.23668, 7.9)
 (3.25779, 0.2)    (3.25779, 0.238693)       (3.25779, 7.9)
 (3.27889, 0.2)    (3.27889, 0.238693)       (3.27889, 7.9)
 (3.3, 0.2)        (3.3, 0.238693)           (3.3, 7.9)</code></pre><p>Evaluate the grid with the machine before and after oversampling</p><pre><code class="language-julia hljs">grid_predictions = [
	predict_mode(mach, Tables.table(reshape(collect(point), 1, 2)))[1] for
	point in grid_points
]
grid_predictions_over = [
	predict_mode(mach_over, Tables.table(reshape(collect(point), 1, 2)))[1] for
	point in grid_points
]
</code></pre><pre><code class="nohighlight hljs">200Ã—200 CategoricalArrays.CategoricalArray{String,2,UInt8}:
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  â€¦  &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  â€¦  &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 â‹®                                       â‹±               
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  â€¦  &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;
 &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;  &quot;setosa&quot;     &quot;virginica&quot;  &quot;virginica&quot;</code></pre><p>Make two contour plots using the grid predictions before and after oversampling</p><pre><code class="language-julia hljs">p = contourf(petal_length_range, petal_width_range, grid_predictions,
	levels = 3, color = :Set3_3, colorbar = false)
p_over = contourf(petal_length_range, petal_width_range, grid_predictions_over,
	levels = 3, color = :Set3_3, colorbar = false)
</code></pre><p>Scatter plot the data before and after oversampling </p><pre><code class="language-julia hljs">labels = unique(y)
colors = Dict(&quot;setosa&quot; =&gt; &quot;green&quot;, &quot;versicolor&quot; =&gt; &quot;yellow&quot;,
	&quot;virginica&quot; =&gt; &quot;purple&quot;)

for label in labels
	scatter!(p, X.petal_length[y.==label], X.petal_width[y.==label],
		color = colors[label], label = label,
		title = &quot;Before Oversampling&quot;)
	scatter!(p_over, Xover.petal_length[yover.==label], Xover.petal_width[yover.==label],
		color = colors[label], label = label,
		title = &quot;After Oversampling&quot;)
end

plot_res = plot(
	p,
	p_over,
	layout = (1, 2),
	xlabel = &quot;petal length&quot;,
	ylabel = &quot;petal width&quot;,
	size = (900, 300),
)
savefig(plot_res, &quot;./visuals/ROSE-before-after.png&quot;)</code></pre><pre><code class="nohighlight hljs">&quot;/Users/essam/Documents/GitHub/Imbalance.jl/examples/visuals/ROSE-before-after.png&quot;</code></pre><p><img src="../visuals/ROSE-before-after.png" alt="before and after SMOTE"/></p><h2 id="Effect-of-Increasing-s"><a class="docs-heading-anchor" href="#Effect-of-Increasing-s">Effect of Increasing <code>s</code></a><a id="Effect-of-Increasing-s-1"></a><a class="docs-heading-anchor-permalink" href="#Effect-of-Increasing-s" title="Permalink"></a></h2><pre><code class="language-julia hljs">anim = @animate for s âˆˆ 0:0.03:1.0
	# oversample
	Xover, yover =
		rose(X, y; s = s, ratios = Dict(&quot;setosa&quot; =&gt; 1.0, &quot;versicolor&quot; =&gt; 1.0), rng = 42)

	# fit machine
	model = KernelPerceptron(kernel = BetaML.Utils.radial_kernel, epochs = 2)
	mach_over = machine(model, Xover, yover)
	fit!(mach_over, verbosity = 0)

	# grid predictions
	grid_predictions_over = [
		predict_mode(mach_over, Tables.table(reshape(collect(point), 1, 2)))[1] for
		point in grid_points
	]

	p_over = contourf(petal_length_range, petal_width_range, grid_predictions_over,
		levels = 3, color = :Set3_3, colorbar = false)

	for label in labels
		scatter!(p_over, Xover.petal_length[yover.==label],
			Xover.petal_width[yover.==label],
			color = colors[label], label = label,
			title = &quot;Oversampling with s=$s&quot;)
	end
	plot!(dpi = 150)
end
</code></pre><pre><code class="nohighlight hljs">Animation(&quot;/var/folders/nq/f_nplzp52qx_hrrhyg44xf4c0000gn/T/jl_ZCYneL&quot;, [&quot;000001.png&quot;, &quot;000002.png&quot;, &quot;000003.png&quot;, &quot;000004.png&quot;, &quot;000005.png&quot;, &quot;000006.png&quot;, &quot;000007.png&quot;, &quot;000008.png&quot;, &quot;000009.png&quot;, &quot;000010.png&quot;  â€¦  &quot;000025.png&quot;, &quot;000026.png&quot;, &quot;000027.png&quot;, &quot;000028.png&quot;, &quot;000029.png&quot;, &quot;000030.png&quot;, &quot;000031.png&quot;, &quot;000032.png&quot;, &quot;000033.png&quot;, &quot;000034.png&quot;])</code></pre><pre><code class="language-julia hljs">gif(anim, &quot;./visuals/rose-animation.gif&quot;, fps=6)
println()</code></pre><pre><code class="nohighlight hljs">â”Œ Info: Saved animation to /Users/essam/Documents/GitHub/Imbalance.jl/examples/visuals/rose-animation.gif
â”” @ Plots /Users/essam/.julia/packages/Plots/3BCH5/src/animation.jl:156</code></pre><p><img src="../visuals/rose-s-animation.gif" alt="oversampling with increasing s"/></p><p>As we can see, the larger <code>s</code> is the more spread out are the oversampled points. This is expected because what ROSE does is oversample by sampling from the distribution that corresponds to placing Gaussians on the existing points and <code>s</code> is a hyperparameter proportional to the bandwidth of the Gaussians. When <code>s=0</code> the only points that can be generated lie on top of others; i.e., ROSE becomes equivalent to random oversampling</p><p>The decision boundary is mainly unstable because we used a small number of epochs with the perceptron to generate this animation. It still took plenty of time.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 8 September 2023 10:58">Friday 8 September 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
